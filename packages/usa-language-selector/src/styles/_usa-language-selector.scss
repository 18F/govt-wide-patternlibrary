@use "uswds-core" as *;

$lang-selector-link-color: color("white");
$lang-selector-arrow-icon-size: 2;
$lang-selector-globe-large-icon-size: 2.5;

$lang-selector-icons: (
  "default": (
    "color": "white",
    "svg-height": 24,
    "svg-width": 24,
  ),
  "caret": (
    "height": units($lang-selector-arrow-icon-size),
  ),
  "globe": (
    "height": units($lang-selector-arrow-icon-size),
    "name": "language",
  ),
  "globe-large": (
    "height": units($lang-selector-globe-large-icon-size),
    "name": "language",
  ),
  "expand": (
    "height": units($lang-selector-arrow-icon-size),
    "name": "expand_more",
  ),
  "collapse": (
    "height": units($lang-selector-arrow-icon-size),
    "name": "expand_less",
  )
);

@function lang-selector-icon($icon-name) {
  $icon-config: map-merge(map-get($lang-selector-icons, "default"), map-get($lang-selector-icons, $icon-name));
  @return $icon-config;
}

.usa-language {
  @include u-flex("row", "align-center", "justify-end");
  display: flex;
  padding: 0 0 units(0.5) units(1);
  width: 100%;

  &--small {
    .usa-button {
      @include u-padding-x(1.5);
      @include u-padding-y(0);
      font-size: font-size($theme-header-font-family, "3xs");
      height: units(4);
      min-width: units($theme-button-small-width);
      &.usa-button--unstyled {
        margin-top: units(0.5);
      }
    }
  }
}

.usa-language-container {
  @include u-flex("align-center", "justify-end");
  display: flex;
  .usa-button {
    span {
      display: flex; 
      align-items: center; 
      @include place-icon(lang-selector-icon("globe-large"), "before");
      &::before {
        margin-right: units(1);
      }
    }
  }
}

.usa-button.usa-language__link {
  margin-right: units(0);
  span {
    display: flex; 
    align-items: center; 
    @include place-icon(lang-selector-icon("globe"), "before");
    &::before {
      margin-right: units(1);
    }
    @include place-icon(lang-selector-icon("expand"), "after");
    &::after {
      margin-left: units(1);
    }
  }
  &[aria-expanded="true"] span {
    @include place-icon(lang-selector-icon("collapse"), "after");
    &::after {
      margin-left: units(1);
    }
  }
}

.usa-nav-container {
  .usa-language-container {
    align-self: flex-end;
    margin-left: units(1.5);
    margin-bottom: units(1.5);
    position: relative;
    right: inherit;
    top: units(-2px);
  }
}

.usa-language__primary {
  width: auto;
}

.usa-language__primary-item:last-of-type {
  position: relative;

  .usa-language__submenu {
    @include u-pin-right;
  }
}

.usa-language__submenu {
  @include add-list-reset;
  @include nav-sublist;
  background-color: color("primary-darker");
  position: absolute;
  width: units("card-lg");
  z-index: z-index(400);

  &[aria-hidden="true"] {
    display: none;
  }

  .usa-language__submenu-item {
    a {
      color: color("white");
      display: block;
      line-height: line-height($theme-navigation-font-family, 3);
      padding: 0;
      padding: units(1);
      text-decoration: none;

      &:focus {
        outline-offset: units("neg-05");
      }

      &:hover {
        color: color("white");
        text-decoration: underline;
      }
    }
  }
}

.usa-language__submenu-list {
  @include unstyled-list;

  .usa-language__submenu-list-item {
    margin: 0;
    font-size: font-size($theme-navigation-font-family, "2xs");

    a {
      line-height: line-height($theme-navigation-font-family, 3);
    }
  }
}
