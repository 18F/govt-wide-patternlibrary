@use "sass:math";
@use "sass:list";

@use "../../../settings" as *;
@use "../../functions/color/get-link-tokens-from-bg" as *;
@use "../../functions/color/get-color-grade" as *;

@mixin set-link-from-bg(
  $bg-color,
  $preferred-link-color: $theme-link-color,
  $fallback-link-color: $theme-link-reverse-color,
  $wcag-target: "AA"
) {
  $link-tokens: get-link-tokens-from-bg(
    $bg-color,
    $preferred-link-color,
    $fallback-link-color,
    $wcag-target
  );

  $link-token: list.nth($link-tokens, 1);
  $hover-token: list.nth($link-tokens, 2);
  $visited-token: if(
    math.abs(get-color-grade($theme-link-visited-color) - get-color-grade($bg-color))
      < 50,
    $link-token,
    $theme-link-visited-color
  );
  color: color($link-token);
  &:visited {
    color: color($visited-token);
  }
  &:hover,
  &:active {
    color: color($hover-token);
  }
}
