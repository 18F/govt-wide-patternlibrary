%usa-table {
  @include border-box-sizing;
  @include typeset;
  border-collapse: collapse;
  border-spacing: 0;
  color: color($theme-table-text-color);
  margin: units(2.5) 0;
  text-align: left;

  thead {
    th {
      font-weight: fw("bold");
      line-height: line-height($theme-body-font-family, $theme-input-line-height);
    }

    th,
    td {
      background-color: color($theme-table-header-background-color);
      color: color($theme-table-header-text-color);
    }
  }

  th,
  td {
    @include u-border(1px, $theme-table-border-color);
    background-color: color("white");
    font-weight: fw("normal");
    padding: units(1) units(2);
  }

  caption {
    @include u-font("body", "xs");
    font-weight: fw("bold");
    margin-bottom: units(1.5);
    text-align: left;
  }


  @mixin table-header-unsorted-styles {
    padding-right: units(5);
    position: relative;
    &:after {
      content: "";
      width: 100%;
      position: absolute;
      bottom: 0;
      left: 0;
      height: 0;
      border-bottom-width: units(1px);
      border-bottom-color: transparent;
      border-bottom-style: solid;
    }
  }

  @mixin table-header-sorted-styles {
    background-color: color("theme-table-sorted-background-color");
    border-width: units(2px) units(2px) units(1px);
    border-left-color: color("theme-table-sorted-border-color");
    border-right-color: color("theme-table-sorted-border-color");
    border-top-color: color("theme-table-sorted-border-color");
    
    // &:after {
    //   border-bottom-color: color("ink");
    // }
  }

  @mixin table-button-default-styles {
    @include button-unstyled;
    // @include add-background-svg("usa-icons/swap_vert");
    position: absolute;
    top: 50%;
    right: .25rem;
    background-position: center center;
    background-size: units(3);
    color: color("ink");
    cursor: pointer;
    display: inline-block;
    margin: 0;
    @include u-square(4);
    text-decoration: none;
    text-align: center;
    transform: translate(0, -50%);
    &:hover {
      // background-color: color("base-lightest");
      // color: color("ink");
    }
    .usa-icon {
      @include u-square(3);
      vertical-align: middle;
      & > g {
        fill: transparent;
      }
    }
  }
  @mixin table-button-unsorted-styles {
    @include table-button-default-styles;
    .usa-icon > g#unsorted {
      fill: color("theme-table-unsorted-icon-color");
    }
  }

  @mixin table-button-sorted-ascending-styles {
    @include table-button-default-styles;
    .usa-icon > g#ascending {
      fill: color("theme-table-sorted-icon-color");
    }
  }
  @mixin table-button-sorted-descending-styles {
    @include table-button-default-styles;
    .usa-icon > g#descending {
      fill: color("theme-table-sorted-icon-color");
    }
  }

  .usa-table__header--sortable {
    @include table-header-unsorted-styles;
  }

  .usa-table__header--sortable:not([aria-sort]),
  .usa-table__header--sortable[aria-sort="none"] {
    .usa-table__header__button {
      @include table-button-unsorted-styles;
    }
  }

  .usa-table__header--sortable[aria-sort="descending"] {
    @include table-header-sorted-styles;
    .usa-table__header__button {
      @include table-button-sorted-descending-styles;
    }
  }

  .usa-table__header--sortable[aria-sort="ascending"] {
    @include table-header-sorted-styles;
    .usa-table__header__button {
      @include table-button-sorted-ascending-styles;
    }
  }

  td[data-sort-active],
  th[data-sort-active] {
    background-color: color("theme-table-sorted-background-color");
    border-left-width: units(2px);
    border-right-width: units(2px);
    border-left-color: color("theme-table-sorted-border-color");
    border-right-color: color("theme-table-sorted-border-color");
  }
  tr:last-child > td[data-sort-active],
  tr:last-child > th[data-sort-active] {
    border-bottom-width: units(2px);
    border-bottom-color: color("theme-table-sorted-border-color");
  }
}

%usa-table--borderless {
  thead {
    th {
      background-color: transparent;
      border-top: 0;
    }
  }

  th,
  td {
    border-left: 0;
    border-right: 0;
  }
}

%usa-table--compact {
  th,
  td {
    padding: units(0.5) units(1.5);
  }
}

%usa-table--striped {
  tbody {
    tr:nth-child(odd) {
      td,
      th {
        background-color: color($theme-table-stripe-background-color);
        color: color($theme-table-stripe-text-color);
      }
    }
  }
}

@mixin table-stacked-styles {
  thead {
    display: none;
  }

  th,
  td {
    border-bottom-width: 0;
    display: block;
    width: 100%;
  }

  tr {
    @include u-border-bottom(0.5, $theme-table-border-color);
    border-top-width: 0;
    display: block;
    width: 100%;
    th:first-child,
    td:first-child {
      border-top-width: 0;
    }
    &:nth-child(odd) {
      td,
      th {
        background-color: inherit;
      }
    }

    &:first-child {
      th:first-child,
      td:first-child {
        @include u-border-top(0.5, $theme-table-border-color);
      }
    }
  }

  th[data-label],
  td[data-label] {
    padding-bottom: units(1.5);

    &:before {
      content: attr(data-label);
      display: block;
      font-weight: fw("bold");
      margin: units(-1) units(-2) units(0);
      padding: units(1.5) units(2) units(0.5);
    }
  }
}

@mixin table-stacked-header-styles {
  tr {
    td:first-child,
    th:first-child {
      @include typeset(
        $theme-body-font-family,
        $theme-h4-font-size,
        $theme-heading-line-height
      );
      background-color: color($theme-table-header-background-color);
      color: color($theme-table-header-text-color);
      font-weight: fw("bold");
      padding: units(1.5) units(2);
      &:before {
        display: none;
      }
    }
  }
}

%usa-table--stacked {
  @include table-stacked-styles;
}

%usa-table--stacked-header {
  @include table-stacked-styles;
  @include table-stacked-header-styles;
}

%usa-table-container--scrollable {
  margin: units(2.5) 0;
  overflow-y: hidden;

  .usa-table {
    margin: 0;
  }

  th,
  td {
    white-space: nowrap;
  }
}
